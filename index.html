<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Morse Code Trainer</title>
<style>
body{margin:0;background:#000;color:#ff2a2a;font-family:Courier,monospace;text-align:center;}
h1{text-shadow:0 0 10px #ff2a2a55;margin-top:20px;}
button{background:#0a0a0a;color:#ff2a2a;border:1px solid #ff2a2a;padding:8px 14px;margin:4px;cursor:pointer;font-family:inherit;}
button:hover{background:#ff2a2a;color:black;}
input{width:80%;padding:10px;font-size:18px;background:#0a0a0a;color:#ff2a2a;border:1px solid #ff2a2a;text-align:center;margin:10px 0;}
.row{margin:6px 0;}
#prompt{font-size:32px;margin:20px;}
#sheet{display:none;position:fixed;right:10px;top:10px;bottom:10px;width:260px;overflow-y:auto;background:#050505;border:1px solid #ff2a2a;padding:10px;text-align:left;}
#introModal{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.95);display:flex;align-items:center;justify-content:center;flex-direction:column;padding:20px;z-index:1000;}
#levelSelect{display:none;margin-top:20px;}
#progressBar{height:20px;background:#222;margin:10px auto;width:80%;border:1px solid #ff2a2a;}
#progressFill{height:100%;width:0%;background:#ff2a2a;}
</style>
</head>
<body>

<h1>Morse Code Trainer</h1>

<div id="introModal">
<p>Press continue to start practicing Morse Code.</p>
<button onclick="startLevelSelect()">Continue</button>
</div>

<div id="levelSelect">
<div>
<label>Difficulty:</label>
<button onclick="setDifficulty('EASY')">Easy</button>
<button onclick="setDifficulty('MEDIUM')">Medium</button>
<button onclick="setDifficulty('HARD')">Hard</button>
</div>
<div id="levelsContainer" style="margin-top:15px;"></div>
</div>

<div id="trainer" style="display:none;">
<div id="prompt">---</div>
<input id="entry" placeholder="type morse here">
<div class="row">
<button onclick="check()">Check</button>
<button onclick="toggleSheet()">Cheat Sheet</button>
</div>
<div id="result"></div>
<div id="score">Score: 0</div>
<div id="progressBar"><div id="progressFill"></div></div>
<div id="timer">Time: 0s</div>
</div>

<div id="sheet"></div>

<script>
const MORSE={A:".-",B:"-...",C:"-.-.",D:"-..",E:".",F:"..-.",G:"--.",H:"....",
I:"..",J:".---",K:"-.-",L:".-..",M:"--",N:"-.",O:"---",P:".--.",
Q:"--.-",R:".-.",S:"...",T:"-",U:"..-",V:"...-",W:".--",X:"-..-",
Y:"-.--",Z:"--..",0:"-----",1:".----",2:"..---",3:"...--",4:"....-",
5:".....",6:"-....",7:"--...",8:"---..",9:"----."};

const EASY_WORDS=["HI","CAT","DOG","BEEP","CODE"];
const MEDIUM_WORDS=["HELLO","RADIO","PYTHON","MORSE"];
const HARD_WORDS=["TRANSMISSION","FREQUENCY","ENCRYPTION"];

let difficulty="EASY";
let levelIndex=0;
let levels=[];
let current="";
let score=0;
let goalScore=100;
let elapsed=0;
let timerInterval;

function random(arr){return arr[Math.floor(Math.random()*arr.length)];}

function startLevelSelect(){
document.getElementById("introModal").style.display="none";
document.getElementById("levelSelect").style.display="block";
buildLevels();
}

function setDifficulty(d){
difficulty=d;
buildLevels();
}

function getLevels(diff){
if(diff==="EASY")return[
{name:"Letters A-E",pool:"ABCDE",unlocked:true},
{name:"Numbers 1-5",pool:"12345",unlocked:false},
{name:"Words A-E",pool:EASY_WORDS,unlocked:false},
{name:"Words+Numbers",pool:"ABCDE1234",unlocked:false},
{name:"Big Numbers",pool:"1234",unlocked:false}
];
if(diff==="MEDIUM")return[
{name:"Letters A-O",pool:"ABCDEFGHIJKLMNO",unlocked:true},
{name:"Numbers 1-7",pool:"1234567",unlocked:false},
{name:"Words",pool:MEDIUM_WORDS,unlocked:false},
{name:"Words+Numbers",pool:"ABCDEFGHIJKLMNO1234567",unlocked:false},
{name:"Big Numbers",pool:"1234567",unlocked:false}
];
return[
{name:"Letters A-Z",pool:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",unlocked:true},
{name:"Numbers 0-9",pool:"0123456789",unlocked:false},
{name:"Words",pool:HARD_WORDS,unlocked:false},
{name:"Words+Numbers",pool:"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",unlocked:false},
{name:"Big Numbers",pool:"0123456789",unlocked:false}
];
}

function buildLevels(){
const container=document.getElementById("levelsContainer");
container.innerHTML="";
levels=getLevels(difficulty);
levels.forEach((lvl,i)=>{
const btn=document.createElement("button");
btn.textContent=lvl.name;
btn.disabled=!lvl.unlocked;
btn.onclick=()=>startLevel(i);
container.appendChild(btn);
});
}

function startLevel(idx){
levelIndex=idx;
score=0;
document.getElementById("levelSelect").style.display="none";
document.getElementById("trainer").style.display="block";
updateScore();
newQuestion();
startTimer();
}

function startTimer(){
clearInterval(timerInterval);
elapsed=0;
document.getElementById("timer").textContent="Time: 0s";
timerInterval=setInterval(()=>{
elapsed++;
document.getElementById("timer").textContent=`Time: ${elapsed}s`;
},1000);
}

function newQuestion(){
const lvl=levels[levelIndex];
if(lvl.pool instanceof Array){
current=random(lvl.pool);
}else if(lvl.name.includes("Big Numbers")){
let length=(difficulty==="EASY"?4:difficulty==="MEDIUM"?7:9);
current="";
for(let i=0;i<length;i++){
current+=random(lvl.pool.split(""));
}
}else{
current=random(lvl.pool.split(""));
}
document.getElementById("prompt").textContent=current;
document.getElementById("entry").value="";
document.getElementById("result").textContent="";
}

function toMorse(text){return text.split("").map(c=>c===" "?"/":MORSE[c]).join(" ");}

function check(){
const user=document.getElementById("entry").value.trim();
const correct=toMorse(current);

if(user===correct){
score+=5;
document.getElementById("result").textContent="Correct ✓\n"+correct;
}else{
score-=5;
if(score<0)score=0;
document.getElementById("result").textContent="Wrong ✗\n"+correct;
}

updateScore();

if(score>=goalScore){
finishLevel();
}else{
setTimeout(newQuestion,800);
}
}

function updateScore(){
document.getElementById("score").textContent=`Score: ${score}`;
updateProgress();
}

function updateProgress(){
const fill=document.getElementById("progressFill");
let percent=Math.max(0,Math.min((score/goalScore)*100,100));
fill.style.width=`${percent}%`;
}

function finishLevel(){
clearInterval(timerInterval);
alert(`Level Complete! Score: ${score} | Time: ${elapsed}s`);
if(levelIndex+1<levels.length)levels[levelIndex+1].unlocked=true;
document.getElementById("trainer").style.display="none";
document.getElementById("levelSelect").style.display="block";
buildLevels();
}

function toggleSheet(){
const sheet=document.getElementById("sheet");
if(sheet.innerHTML==="")sheet.innerHTML=Object.keys(MORSE).sort().map(k=>`${k} : ${MORSE[k]}`).join("<br>");
sheet.style.display=sheet.style.display==="none"?"block":"none";
}
</script>
</body>
</html>
